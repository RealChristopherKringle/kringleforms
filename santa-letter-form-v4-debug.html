
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Santa Letter Form (Debug Version)</title>
  <style>
    body { font-family: Arial, sans-serif; background-color: #fffbea; padding: 20px; }
    #santa-form { max-width: 600px; margin: auto; background: #ffffff; padding: 25px; border-radius: 12px; border: 2px solid #e2b8a1; }
    label { font-weight: bold; margin-top: 10px; display: block; }
    input, select, textarea { width: 100%; padding: 10px; margin: 6px 0 16px; border-radius: 6px; border: 1px solid #ccc; box-sizing: border-box; }
    button { width: 100%; background-color: #d84315; color: white; padding: 14px; border: none; border-radius: 8px; font-size: 16px; cursor: pointer; }
    #confirmation, #tracker { display: none; max-width: 600px; margin: 20px auto; padding: 20px; border-radius: 10px; }
    #confirmation { background: #fff3e0; border: 2px dashed #c62828; text-align: center; }
    #tracker { background: #f3faff; border: 2px solid #90caf9; }
    #tracking-steps li { opacity: 0.4; transition: opacity 0.4s; list-style: none; margin-bottom: 8px; }
  </style>
</head>
<body>
  <form id="santa-form">
    <h2>🎅 Write Your Letter to Santa</h2>
    <label>Your Name:</label>
    <input type="text" name="name" required />
    <label>Your Age:</label>
    <select name="age" required>
      <option value="">Select Age</option><option>1</option>
<option>2</option>
<option>3</option>
<option>4</option>
<option>5</option>
<option>6</option>
<option>7</option>
<option>8</option>
<option>9</option>
<option>10</option>
<option>11</option>
<option>12</option>
<option>13</option>
<option>14</option>
<option>15</option>
<option>16</option>
<option>17</option>
<option>18</option>
<option>19</option>
<option>20</option>
<option>21</option>
<option>22</option>
<option>23</option>
<option>24</option>
<option>25</option>
<option>26</option>
<option>27</option>
<option>28</option>
<option>29</option>
<option>30</option>
      <option>31+</option>
      <option>Adult with special needs</option>
      <option>Adult (parent, helper, or Santa fan)</option>
    </select>
    <label>Your Grade:</label>
    <select name="grade" required>
      <option value="">Select Grade</option>
      <option>Preschool</option><option>Kindergarten</option><option>1st Grade</option><option>2nd Grade</option>
      <option>3rd Grade</option><option>4th Grade</option><option>5th Grade</option><option>6th Grade</option>
      <option>7th Grade</option><option>8th Grade</option><option>High School</option><option>College or Adult</option>
    </select>
    <label>Your Country:</label>
    <input type="text" name="country" required />
    <label>Your Wish:</label>
    <textarea name="wish" required></textarea>
    <label>Your Email:</label>
    <input type="email" name="email" required />
    <button type="submit">🎁 Send My Letter to Santa</button>
  </form>

  <div id="confirmation">
    <h3>🎅 Santa Received Your Letter!</h3>
    <p>Your message is on its way to the North Pole.</p>
  </div>

  <div id="tracker">
    <h3>📦 Tracking Your Letter</h3>
    <ul id="tracking-steps">
      <li>🔄 Preparing magical transport...</li>
      <li>🧤 Scanned by Glove Inspection Team</li>
      <li>📝 Reviewed by Mrs. Claus</li>
      <li>🧝‍♂️ Assigned to Elf #728</li>
      <li>📬 Delivered to Santa’s desk!</li>
    </ul>
  </div>

  <audio id="sparkle-audio" preload="auto">
    <source src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_353ffed97c.mp3?filename=magic-sparkle-1-191444.mp3" type="audio/mpeg">
  </audio>

  <script type="module">
    import emailjs from 'https://cdn.emailjs.com/dist/email.min.mjs';

    window.addEventListener("load", () => {
      console.log("🎄 Script loaded");
      emailjs.init("P-b54wYCmhmC0sd6R");

      const form = document.getElementById("santa-form");
      const confirmation = document.getElementById("confirmation");
      const tracker = document.getElementById("tracker");
      const steps = document.querySelectorAll("#tracking-steps li");
      const sparkle = document.getElementById("sparkle-audio");

      form.addEventListener("submit", function (e) {
        e.preventDefault();
        console.log("📝 Form submitted");

        const age = parseInt(form.age.value);
        const templateId = isNaN(age) || age < 5 ? "santa_email_under5" : "santa_email_5plus";

        emailjs.sendForm("service_lh5tjal", templateId, form).then(() => {
          console.log("✅ EmailJS send successful");
          alert("Santa received your message!");
          form.reset();
          confirmation.style.display = "block";
          tracker.style.display = "block";
          steps.forEach((step, i) => {
            setTimeout(() => {
              step.style.opacity = 1;
              if (i === steps.length - 1 && sparkle) {
                sparkle.volume = 0.6;
                sparkle.play().catch(() => {});
              }
            }, 800 * (i + 1));
          });
        }).catch((error) => {
          console.error("❌ EmailJS error:", error);
          alert("Something went wrong: " + error.text);
        });
      });
    });
  </script>
</body>
</html>
